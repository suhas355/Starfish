<!DOCTYPE>
<html>
	<head>
		<meta charset="UTF-8">
		<title class='login-title'>S.E.A</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
  		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

  		<script src="javascripts/login.js"></script> 
  		<link rel="stylesheet" type="text/css" href="stylesheets/login.css">
		<script>
   			function loginProcess() {
   				console.log('what??');
			    var purl = "/login/process"; // the script where you handle the form input.
				uname = $('#login').find('input[name="userId"]').val();

			    pass = $('#login').find('input[name="password"]').val();
			    content = {
			    			"username":uname,
			    			"password":pass
			    		}
			    	console.log('what??');
			    $.ajax({
			           type: "POST",
			           url: purl,
			           dataType: 'json',
			           data: content,
			          

	           success: function(data)
	           {	
	           	   // alert('moving to main');
	           		console.log('success received in js');
	           		window.location.href = '/main'
	           		
	           },
	           error: function(data)
	           {
	           		 console.log('error received in js');
	           		 window.location.href = '/'

	           		//window.location.href = '/'

	           		/*var obj = JSON.parse(data);
	           		window.location.href = obj.url;*/
	           }
	          
         })
			.done(function(data){
				if(data.access=='success'){
						console.log('correct output final');
						window.location.href = '/main';
				}else{
						console.log('error final');
						window.location.href = '/';
				}
			});

		}
    </script>
 
	</head>
	<body>
		<form class="login" id="login" method="post">
			  
			<fieldset>
			    
			<legend class="legend">Login</legend>
			    
			<div class="input">
			  	<input type="text" name="userId" placeholder="201XXXXXX" required pattern="201\d{6}" 
			  	oninvalid="setCustomValidity('Please enter your valid rollnumber')"/>
			    <span><i class="fa fa-envelope-o"></i></span>
			</div>
			    
			<div class="input">
			  	<input type="password" name="password" placeholder="Password (****)" required 
			  	pattern="\d{4}" oninvalid="setCustomValidity('check courses portal for your secret key')"/>
			    <span><i class="fa fa-lock"></i></span>
			</div>
			    
			<button type="submit" onclick="javascript:loginProcess();" class="submit"><i class="fa fa-long-arrow-right"></i></button>
			    
			</fieldset>
			  
			<div class="feedback">
			  	login successful <br />
			    redirecting...
			</div>
  
		</form>

		<footer>
			<p class="footer">Copyright &copy; GS355</p>
		</footer>

	</body>
</html>